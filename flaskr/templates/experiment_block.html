<div class="container">
    <h2>{{ device.params.name }}</h2>
    <div class="alert alert-info" role="alert">
        <strong>Статус:</strong> <span id="experiment-status">{{ device.params.status }}</span> |
        <strong>Последнее обновление:</strong> <span id="last-update">{{ device.params.last_response }}</span>
    </div>
    
    <div class="mb-3">
        <label for="command-select" class="form-label">Команды</label>
        <select id="command-select" class="form-select">
            {% for command in device.commands.keys() %}
                <option value="{{ command }}">{{ command }}</option>
            {% endfor %}
        </select>
    </div>
    
    <div class="mb-3">
        <label for="command-args" class="form-label">Аргументы</label>
        <input type="text" id="command-args" class="form-control" placeholder="Введите аргументы">
    </div>
    
    <button type="button" class="btn btn-primary" onclick="sendExperimentCommand()">Отправить команду</button>
    
    <div class="progress mt-3">
        {% set total_stages = device.params.stages | length %}
        {% set progress_percentage = (device.params.step / (total_stages - 1)) * 100 if total_stages > 1 else 100 %}
        
        <div class="progress-bar" role="progressbar" style="width: {{ progress_percentage }}%;" aria-valuenow="{{ progress_percentage }}" aria-valuemin="0" aria-valuemax="100">
            Шаг {{ device.params.step }}/{{ total_stages }} - {{ device.params.current_stage_name }}
        </div>
    </div>
    <!-- Parameters Table -->
    <div id="paramsTable{{ device.params.device_id }}" style="display: none;">
        <table class="table">
            <thead>
                <tr>
                    <th>Parameter</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                {% for param, value in device.params.items() %}
                    <tr>
                        <td>{{ param }}</td>
                        <td>{{ value }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>